let regType='create';async function loadEvents(){const res=await fetch('/api/events');const evs=await res.json();document.getElementById('eventSelect').innerHTML=evs.map(e=>`<option value='${e.id}'>${e.title}</option>`).join('');}loadEvents();window.switchReg=(type)=>{regType=type;const btns=document.querySelectorAll('.auth-toggle-btn');if(type==='create'){btns[0].classList.add('active');btns[1].classList.remove('active');document.getElementById('regTitle').innerText="CREATE NEW TEAM";document.getElementById('eventGroup').style.display="block";document.getElementById('teamIdGroup').style.display="none";document.getElementById('joinTeamId').required=false;}else{btns[1].classList.add('active');btns[0].classList.remove('active');document.getElementById('regTitle').innerText="JOIN TEAM";document.getElementById('eventGroup').style.display="none";document.getElementById('teamIdGroup').style.display="block";document.getElementById('joinTeamId').required=true;}};document.getElementById('regForm').onsubmit=async(e)=>{e.preventDefault();const body={type:regType,name:document.getElementById('name').value,email:document.getElementById('email').value,eventId:document.getElementById('eventSelect').value,joinTeamId:document.getElementById('joinTeamId').value};const res=await fetch('/api/register',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(body)});const data=await res.json();const msg=document.getElementById('regMsg');msg.innerText=data.message;msg.style.color=data.success?'#00ff00':'#ff0000';if(data.success)setTimeout(()=>window.location.href='/login',2000);};